{
  // Use a Dockerfile build to avoid relying on GHCR feature resolution (which may require auth).
  "build": {
    "dockerfile": "Dockerfile"
  },
  "runArgs": [
    // Mount Docker socket so the container can access the host Docker daemon (useful on Docker Desktop/WSL)
    "-v",
    "/var/run/docker.sock:/var/run/docker.sock"
  ],
  "customizations": {
    "vscode": {
      "extensions": [
        "GitHub.copilot",
        "GitHub.copilot-chat",
        // Docker and remote development helpers
        "ms-azuretools.vscode-docker",
        "ms-vscode-remote.remote-containers",
        // PHP tooling
        "bmewburn.vscode-intelephense-client",
        "felixfbecker.php-debug",
        "felixfbecker.php-intellisense",
        "junstyle.php-cs-fixer",
        "kokororin.vscode-phpfmt",
        "neilbrayfield.php-docblocker"
      ],
      "settings": {
        "php.validate.executablePath": "/usr/local/bin/php",
        "intelephense.files.maxSize": 5000000
      }
    }
  },
  // Run after container is created to ensure PHP, composer and extensions are installed and to install dependencies
  "postCreateCommand": ".devcontainer/scripts/install-php-requirements.sh || true"
}